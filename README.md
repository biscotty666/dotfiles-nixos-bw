# My laptop

Configuration with flakes and dev shells.

## Nixos system install with flakes

1. Install NixOS with defaults, allow unfree software, create user
2. Add git, vi, alacritty and rebuild
3. Create the `dotfiles` directory and clone the repository.
4. Copy the configuration.nix to `/etc/nixos`, adjust user name and rebuild
5. Log out and in
6. Switch to `dotfiles`, copy the hardware configuration from `/etc/nixos` and rebuild with `sudo nixos-rebuild switch --flake .`
7. Add home-manager channels with 
```
$ nix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager
$ nix-channel --update
```
8. Log out and in
9. Run `nix-shell '<home-manager>' -A install`
10. Log out and in
12. In `dotfiles` run `home-manager switch --flake .`
13. Log out an in once more

## Set up a dev environment

1. Create a directory for the project
2. Copy the flake.nix, flake.lock and envrc into the directory
3. Edit the flake to add/remove libraries. (Building all the ml and spatial libraries takes a long time.)
4. Run `direnv allow`

## Notes

- The `hardware-configuration.nix` should not be used. NixOS is tightly
integrated with git, and adding this file to `.gitignore` caused problems. As
per the instructions, use the file generated by the install process.
- To launch a windows VM use `quickget windows 11` followed by `quickemu --vm windows-11.conf`

Please let me know if something doesn't work.

Python flake
[source](https://dev.to/deciduously/workspace-management-with-nix-flakes-jupyter-notebook-example-2kke) (Thank you) 
