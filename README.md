# My laptop

Configuration with flakes and dev shells.

## Nixos system install with flakes

1. Install NixOS with defaults, allow unfree software, create user named `guest`
2. Add/uncomment vim, git and `nix.settings.experimental-features = [ "nix-command" "flakes" ];` and rebuild with `sudo nixos-rebuild switch`
4. Create the `dotfiles` directory and clone the repository.
5. Copy the configuration.nix to `/etc/nixos` and rebuild
6. Log out and in
7. Switch to `dotfiles`, copy the hardware configuration from `/etc/nixos` and rebuild with `sudo nixos-rebuild switch --flake .`
8. Add home-manager channels with 
```
$ nix-channel --add https://github.com/nix-community/home-manager/archive/master.tar.gz home-manager
$ nix-channel --update
```
9. Log out and in
10. Run `nix-shell '<home-manager>' -A install`
11. Log out and in
12. In `dotfiles` run `home-manager switch --flake .`
13. Log out an in once more

## Set up a dev environment

1. Create a directory for the project
2. Copy the flake.nix, flake.lock and envrc into the directory
3. Edit the flake to add/remove libraries. (Building all the ml and spatial libraries takes a long time.)
4. Run `direnv allow`

## Notes

- The `hardware-configuration.nix` should not be used. NixOS is tightly
integrated with git, and adding this file to `.gitignore` caused problems. As
per the instructions, use the file generated by the install process.
- To launch a windows VM use `quickget windows 11` followed by `quickemu --vm windows-11.conf`

Please let me know if something doesn't work.

Python flake
[source](https://dev.to/deciduously/workspace-management-with-nix-flakes-jupyter-notebook-example-2kke) (Thank you) 
